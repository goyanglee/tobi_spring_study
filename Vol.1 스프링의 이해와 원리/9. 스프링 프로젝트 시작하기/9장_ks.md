# 9장 스프링 프로젝트 시작
### 클라이언트와 백엔드 시스템 
웹 브라우저 외에도 자바가 요청받을 수 있는 형태로 보내기만 한다면 어떠한 클라이언트든 상관없이 데이터베이스, 메시징 서버 ,레거시 시스템 등의 백엔드 시스템과 연결하는 애플리케이션 서버로서 동작한다. 
### 애플리케이션 서버 
스프링 애플리케이션은 JavaEE 서버가 필요하다.
JavaEE 서버 
1. 경량급 WAS/서블릿 컨테이너 
톰캣, 제티같은 가벼운 서블릿 컨테이너만 있어도 그 위에서 스프링은 동작할 수 있다. 
2. WAS 
고가의 서버 

### 배포단위 
1. 독립 웹 모듈 : war로 패키징 된 독립 웹 모듈로 배포된다. 서블릿 컨테이너 위에서 동작하기 위해선 유일한 방법이다. 
2. 엔터프라이즈 애플리케이션 : ear 엔터프라이즈 애플리케이션으로 패키징 
3. 백그라운드 서비스 모듈 : rar 패키징으로 백그라운드 서비스처럼 동작하게 함.

## 개발도구와 환경 
### JavaSE와 JavaEE 
1. JavaSE / JDK 
스프링 3부터는 JDK 5이상 
2. JavaEE/J2EE 
스프링 3.0이 사용될 자바 엔터프라이즈 플랫폼은 J2EE 1.4 / JavaEE 5.0이 필요하다. 
### IDE 
통합개발환경 
### STS (SpringSource Tool Suite)
이클립스 툴을 사용한다면 스프링소스가 직접 만들어 제공하는 이클립스의 확장판 STS가 있다.
### 빌드툴과 라이브러리 관리 
Maven , Ant 는 자바의 대표적인 빌드 툴이다. 지정된 라이브러리가 동작하는데 필요한 여타 라이브러리까지 함께 다운로드해주는 기능이다. 

## 애플리케이션 아키텍쳐 
### 계층형 아키텍처 
애플리케이션을 구성하는 오브젝트들을 비슷한 성격과 책임을 가진 것들끼리 묶어 분리해두는 것을 아키텍쳐 차원에서 계층형 아키텍처라고 한다. 보통 웹 기반에서는 3개의 층을 갖는다고 해서 3계층 애플리케이션이라고도 한다. 
#### 3계층 아키텍처 
1. 데이터 엑세스 계층 : DAO 계층. db, ERP, 레거시 시스템등에 접근하는 계층. eis(Enterprise Information System)dlfkrheh gksek. 
1.1 JDBCTemplate
1.2 JDBC, 트랜잭션 동기화
1.3 DataSource
2. 서비스 계층 : POJO 로 작성되어 비즈니스 로직의 핵심을 담아낸다. 원격 호출을 통해 데이터를 가져오거나 메시징 서비스를 이용한다. 
2.1 서비스 계층
2.2 기반 서비스 계층 : 트랜잭션, 보안, 원격, 메일, 메시징, 스케쥴링 등 
3. 프레젠테이션 계층 
HTTP 프로토콜을 처리해서 클라이언트와 연결되어 동작한다. 
RiA, SOFEA 아키텍처가 대표적이다. 아예 이 계층을 통째로 스프링이 아닌 웹 기술을 가젿다 쓸 수 있다.

#### 계층형 아키텍쳐 설계 원칙 
1. 각 계층은 응집도가 높으면서 다른 계층과 낮은 결합도를 유지해야 한다.

### 애플리케이션 정보 아키텍처 
#### 데이터 중심 아키텍처
단순히 값을 담기 위한 목적의 오브젝트 형태로 데이터를 취급하는 구조. 
1. DB/SQL 중심의 로직 구현 방식 
프론트에서 필요한 데이터를 SQL이 전부 알고있으므로 의존도가 높고, 수정이 어렵다. 
2. 거대한 서비스 계층 방식 
저장 프로시저를 사용해 복잡한 SQL은 피하고 주요 로직은 서비스 계층의 코드로 처리한다.  구조는 단순해지고 객체지향 개발의 장점을 살릴 수 있다. 단, 스파게티 코드로 전락할 위험도 있다. 
#### 오브젝트 중심 아키텍쳐 
객체지향 분석과 모델링의 결과로 나오는 도메인 모델을 오브젝트 모델로 활용한다. 데이터베이스의 엔티티구조와 유사할 가능성이 높다. 
1. 데이터와 오브젝트 
데이터베이스 테이블의 구조를 반영해서 만들어진 오브젝트에 데이터가 담긴다. 
**문제점**
최적화된 SQL을 사용하는 경우에 비해 성능 면에서 손해가 있을 수 있다. 필요없는 필드나 데이터가 있을 수 있기 때문이다. 
**해결**
1. 지연로딩을 통해 필요한 경우에만 다이나믹하게 데이터베이스에서 다시 읽어온다.
2. JPA, 하이버네이트 등 ORM 기술을 사용한다. 
 
 도메인 오브젝트는 자바 오브젝트다. 접근자, 수정자만 가지고 있는 것은 반쪽짜리 오브젝트다. 내부의 데이터를 활용해 확인할 수 있는 데이터들은 내부 함수로 구현하면 좀 더 풍성한 도메인 오브젝트를 만들 수 있다. 응집도가 높아진다. 

도메인 오브젝트는 DI받아서 사용할 수 없다. 빈이 아니기 때문이다. 

도메인 오브젝트가 스스로 필요한 정보를 DAO를 통해 crud할 수 있을까?
##### 도메인 계층 방식 
도메인 오브젝트들이 하나의 독립적인 계층을 이뤄서 서비스 계층과 데이터 엑세스 계층 사이에 존재한다. 
**특징**
1. 도메인 계층의 오브젝트안에서 도메인에 종속적인 비즈니스 로직을 처리한다. 
2. 도메인 오브젝트가 데이터 엑세스 계층과 기반 계층의 기능을 직접 활용할 수 있다. DI를 적용할 수 없기 때문에 AOP를 활용한다. 도메인 오브젝트가 생성되는 시점에 특별한 부가기능을 만들어줄 수 있다. 이 부가기능은 DI가능한 대상을 찾아줘서 빈 오브젝트를 DI받게 할 수 있다.(?) 

**계층을 벗어나서도 사용하게 할 것인가?**
1. 모든 계층에서 도메인 오브젝트를 사용할 수 있게 한다. 
 함부로 사용하면 임의로 프론트에서도 호출할 수 있게 된다.
 2. 벗어나지 못하게 한다. 이를 DTO(Data Transfer Object)라고 한다. 기능을 갖지 않아 사용하기 안전하다. 

![그림 9-22](url)

##### DTO와 리포트 쿼리 
데이터베이스의 실행 결과를 담는 리포트 쿼리에 주로 사용된다.

### 스프링 아키텍쳐 설계 
#### 계층형 아키텍쳐 
3계층 구조. 프레젠 테이션 계층은 보통 MVC 패턴, MVC2, SOFEA 패턴을 사용한다.
#### 정보 전송 아키텍처 
도메인 오브젝트를 계층 간의 정보 전송을 위해 사용한다. 프레젠테이션 계층의 MVC 모델은 도메인 오브젝트를 그대로 사용한다. 
#### 상태 관리와 빈 스코프 
애플리케이션의 상태와 장시간 진행되는 작업 정보는 유지되어야 하고 ㅇ를 데이터베이스에 저장하거나 세션과 같은 저장공간을 활용한다. 
#### 서드파티 프레임워크, 라이브러리 적용 
스프링이 지원하는 기술이란?
1. 스프링의 DI 패턴을 따라 사용할 수 있다.
2. 스프링의 서비스 추상화가 적용됐다. 
3. 스프링이 지지하는 프로그래밍 모델을 적용했다.
4. 템플릿/콜백이 지원된다.
