# 1장. IOC 컨테이너와 DI

**IOC/DI** : 사실상 자바의 표준 프로그래밍 모델

스프링 외에도, IOC/DI를 제공하는 것은 많지만, **스프링만큼 유연하고 강력한 기능을 가진 IOC 컨테이너와 DI 기술을 제공하는 것은 없다.**

# 1.1 IOC 컨테이터 : 빈 팩토리와 애플리케이션 컨텍스트

**스프링 어플리케이션**에서는 오**브젝트의 생성과 관계설정, 사용, 제거 등의 작업을 애플리케이션 코드 대신 독립된 컨테이너가 담당**.

이를 **컨테이너가 코드대신 오브젝트에 제어권을 갖고 있다**고 해서 **IOC** 라고 부른다.

### 스프링 컨테이너 = IOC 컨테이너

스프링에선 **IOC를 담당하는 컨테이너**를 **빈 팩토리 또는 애플리케이션 컨텍스트**라고 부른다.

오브젝트 생성과 오브젝트 사이의 런타임 관계를 설정하는 DI 관점으로 볼 때는 컨테이너를 빈 팩토리라고 한다. 

그런데 스프링 컨테이너는 단순한 DI 작업보다 더 많은 일을 한다.

DI를 위한 빈 팩토리에 엔터프라이즈 애플리케이션을 개발하는 데 필요한 여러 가지 컨테이너 기능을 추가한 것을 애플리케이션 컨텍스트라고 부른다.

애플리케이션 컨텍스트는 그 자체로도 IOC와 DI를 위한 빈 팩토리이면서 그 이상의 기능을 가졌다고 보면 된다.

스프링의 IOC컨테이너는 일반적으로 애플리케이션 컨텍스트를 말한다.

```java
public interface ApplicationContext extends ListableBeanFactory,
  HierarchicalBeanFactory, MessageSource, ApplicationEventPiblisher,
  ResourcePatternResolver {
```

= ApplicationContext 인터페이스를 구현한 클래스의 오브젝트

= 스프링 컨테이너  또는 IOC컨테이너라고 말하는 것은 바로 이 ApplicationContext 인터페이스를 구현한 클래스의 오브젝트다. 

스프링 애플리케이션은 최소한 하나 이상의 IoC컨테이너, 즉 애플리케이션 컨텍스트 오브젝트를 가지고 있다. 하나 이상이라고 하는 이유는 한 개 이상의 애플리케이션 컨텍스트 오브젝트를 갖고 있는 경우도 많기 때문이다.

## 1.1.1 IoC컨테이너를 이용해 애플리케이션 만들기

간단하게 IOC 컨테이너 만드는 법 : ApplicationContext 구현 클래스의 인스턴스를 만드는 것

```java
StaticApplicaionContext ac = new StaticApplicationContext();
```

→ 빈 컨테이너

이러한 빈 컨테이너를 본격적인 IOC 컨테이너로 동작하게 하려면 **POJO 클래스와 설정 메타정보** 두가지가 필요하다. 

### POJO 클래스

: 애플리케이션의 핵심 코드를 담고 있다.

: 각각의 POJO는 특정 기술과 스펙에서 독립적일뿐더러 의존관계에 있는 다른 POJO와 느슨한 결합을 갖도록 만들어야 한다.

: POJO 코드를 설계할 때는 일단 유연한 변경 가능성을 고려해서 만든다.

![1%E1%84%8C%E1%85%A1%E1%86%BC%20IOC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%2050e3a23badf64a6fb6e2cbe7b7f6fc7a/Untitled.png](1%E1%84%8C%E1%85%A1%E1%86%BC%20IOC%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%8B%E1%85%AA%20DI%2050e3a23badf64a6fb6e2cbe7b7f6fc7a/Untitled.png)

### 설정 메타정보

만든 POJO 클래스 들 중에 애플리케이션에서 사용할 것을 선정하고 이를 IoC컨테이너가 제어할 수 있도록 적절한 메타정보를 만들어 제공하는 작업이 필요하다.

IoC컨테이너의 가장 기초적인 역할은 오브젝트를 생성하고 이를 관리하는 것이다.

스프링 컨테이너가 관리하는 이런 오브젝트는 빈(bean)이라고 부른다.

IoC컨테이너가 필요로 하는 설정 메타정보는 바로 이 빈을 어떻게 만들고 어떻게 동작하게 할 것인가에 관한 정보다.

→ Bean : 스프링 컨테이너가 관리하는 오브젝트. 

    IoC컨테이너 : 가장 기초적인 역할은 Bean을 생성하고 이를 관리하는 것.

    설정 메타정보 : IoC컨테이너가 이 빈을 어떻게 만들고, 어떻게 동작하게 할 것인가에 대한 정보를 담고 있는 것.

- 스프링 설정 메타정보는 BeanDefinition 인터페이스로 표현되는 순수한 추상정보다.
- IoC 컨테이너(애플리케이션 컨텍스트는) 이 BeanDefinition으로 만들어진 메타정보를 담은 오브젝트를 사용해 IoC와 DI 작업을 수행한다.
- BeanDefinition는 파일의 제한을 받지않고 으로 정의되는 스프링의 설정 메타정보의 내용을 표현한 것이 있다면 무엇이든 사용 가능하다.
- 원본의 포맷과 구조, 자료의 특성에 맞게 읽어와 BeanDefinition 오브젝트로 변환해주는 BeanfinitionReader가 있으면 된다.

<BeanDefinition 인터페이스로 정의되는, IoC컨테이너가 사용하는 메타정보>

- 빈 아이디, 이름, 별칭 : 빈 오브젝트를 구분할 수 있는 식별자
- 클래스 또는 클래스 이름 : 빈으로 만들 POJO 클래스 또는 서비스 클래스 정보
- 스코프 : 싱글톤, 프로토 타입과 같은 빈의 생성방식과 존재범위
- 프로퍼티 값 또는 참조 : DI에서 사용할 프로퍼티 이름과 값 또는 참조하는 빈의 이름
- 생성자 파라미터 값 또는 참조: DI에 사용할 생성자 파라미터 이름과 값 또는 참조할 빈의 이름
- 지연된 로딩 여부, 우선 빈 여부, 자동와이어링 여부, 부모 빈 정보, 빈팩토리 이름 등

> 즉, 스프링 애플리케이션 이란, POJO 클래스와 설정 메타정보를 이용해 IoC컨테이너가 만들어주는 오브젝트의 조합